/* Rainbow v1.0 craig.is/making/rainbows */
window.Rainbow=function(){function A(b){var c=b.getAttribute&&b.getAttribute("data-language")||null;if(!c){var b=b.attributes.length,a;for(a=0;a<b;++a)"data-language"==="data-language"[a].nodeName&&(c="data-language"[a].nodeValue)}return c}function B(b,c){for(var a in f[e]){a=parseInt(a,10);if(b==a&&c==f[e][a]?0:b<=a&&c>=f[e][a])delete f[e][a],delete h[e][a];if(b>=a&&b<f[e][a]||c>a&&c<f[e][a])return!0}return!1}function o(b,c){return'<span class="'+b.replace(/\./g," ")+'">'+c+"</span>"}function C(b,
c){var a=b.index,d;for(d=1;d<c;++d)b[d]&&(a+=b[d].length);return a}function p(b,c,a,d){var i=b.exec(a);if(i){++q;var g=i[0],j=i.index,r=i[0].length+j,s=function(){function i(){p(b,c,a,d)}0<q%100?i():setTimeout(i,0)};if(B(j,r))s();else{var k=t(c.matches),l=function(a,b,d){if(a>=b.length)d(g);else{var e=function(){l(++a,b,d)},f=i[b[a]];if(f){var j=c.matches[b[a]],h=j.language;h?u(f,h,function(a){g=g.replace(f,a);e()}):"object"===typeof j?v(f,j.length?j:[j],function(a){g=g.replace(f,a);e()}):(g=w(C(i,
b[a])-i.index,f,o(j,f),g),e())}else e()}};l(0,k,function(a){c.name&&(a=o(c.name,a));h[e]||(h[e]={},f[e]={});h[e][j]={replace:i[0],"with":a};f[e][j]=r;s()})}}else d()}function D(b){var c=k[b]||[],a=k[x]||[];return y[b]?c:c.concat(a)}function w(b,c,a,d){return d.substr(0,b)+d.substr(b).replace(c,a)}function t(b){var c=[],a;for(a in b)b.hasOwnProperty(a)&&c.push(a);return c.sort(function(a,b){return b-a})}function v(b,c,a){function d(c,g){g<c.length?p(c[g].pattern,c[g],b,function(){d(c,++g)}):E(b,function(b){delete h[e];
delete f[e];--e;a(b)})}++e;d(c,0)}function E(b,c){function a(b,c,d,f){if(d<c.length){++z;pos=c[d];replacement=h[e][pos];var b=w(pos,replacement.replace,replacement["with"],b),k=function(){a(b,c,++d,f)};0<z%250?k():setTimeout(k,0)}else f(b)}var d=t(h[e]);a(b,d,0,c)}function u(b,c,a){v(b,D(c),function(b){a(b)})}function l(b,c){if(c<b.length){var a=A(b[c]);a?(a=a.toLowerCase(),b[c].className=a,u(b[c].innerHTML,a,function(a){b[c].innerHTML=a;h={};f={};m&&m(b[c]);setTimeout(function(){l(b,++c)},0)})):
l(b,++c)}}var h={},f={},k={},y={},e=0,x=0,q=0,z=0,m;return{extend:function(b,c,a){1==arguments.length&&(c=b,b=x);y[b]=a;k[b]=c.concat(k[b]||[])},b:function(b){m=b},a:function(){var b=document.getElementsByTagName("pre"),c=document.getElementsByTagName("code"),a,d=[];for(a=c.length>>>0;a--;)d[a]=c[a];for(a=0;a<b.length;++a)b[a].getElementsByTagName("code").length||d.push(b[a]);l(d,0)}}}();var n=window;n.addEventListener?n.addEventListener("load",Rainbow.a,!1):n.attachEvent("onload",Rainbow.a);
Rainbow.onHighlight=Rainbow.b;